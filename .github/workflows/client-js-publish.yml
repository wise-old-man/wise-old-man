name: (Client JS) Publish to NPM

on:
  pull_request: # change to push after dry run is checked
    branches:
      - master
    paths:
      - "client-js/**"

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout master branch
        uses: actions/checkout@v3
        with:
          ref: master

      - name: Get master npm version
        id: master-package-version
        uses: martinbeentjes/npm-get-version-action@main
        with:
          path: client-js

      - name: Checkout current branch
        uses: actions/checkout@v3

      - name: Get current npm version
        id: current-package-version
        uses: martinbeentjes/npm-get-version-action@main
        with:
          path: client-js

      - name: Compare both versions
        id: version-check
        if: ${{steps.master-package-version.outputs.current-version}} == ${{steps.current-package-version.outputs.current-version}}
        uses: andymckay/cancel-action@0.2

      - name: Wow?
        run: echo "yes?!?!?!?!?"
